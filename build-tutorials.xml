<?xml version="1.0" encoding="UTF-8"?>
<project name="pivot" default="build">
    <property name="src" value="src"/>
    <property name="bin" value="ant-bin"/>
    <property name="tutorials" value="tutorials"/>

    <!-- Compiler properties -->
    <property name="compiler.optimize" value="true"/>
    <property name="compiler.deprecation" value="true"/>
    <property name="compiler.debug" value="true"/>

    <!-- Build tutorial library -->
    <target name="build">
        <mkdir dir="${tutorials}/${bin}"/>

        <!-- Compile source files -->
        <javac srcdir="${tutorials}/${src}" destDir="${tutorials}/${bin}" optimize="${compiler.optimize}" deprecation="${compiler.deprecation}" debug="${compiler.debug}" failonerror="true">
            <compilerarg value="-Xlint"/>
            <classpath>
                <pathelement location="core/pivot-core.jar"/>
                <pathelement location="web/pivot-web.jar"/>
                <pathelement location="wtk/pivot-wtk.jar"/>
            </classpath>
        </javac>

        <!-- Rebuild the JAR files -->
        <delete file="${tutorials}/${ant.project.name}-tutorials.jar"/>
        <jar jarfile="${tutorials}/${ant.project.name}-tutorials.jar">
            <fileset dir="${tutorials}/${bin}">
                <exclude name="pivot/tutorials/stocktracker/**"/>
            </fileset>
            <fileset dir="${tutorials}/${src}">
                <exclude name="**/*.java"/>
                <exclude name="pivot/tutorials/stocktracker/**"/>
            </fileset>
        </jar>
        
        <delete file="${tutorials}/${ant.project.name}-stocktracker.jar"/>
        <jar jarfile="${tutorials}/${ant.project.name}-stocktracker.jar">
            <fileset dir="${tutorials}/${bin}">
                <include name="pivot/tutorials/stocktracker/*"/>
            </fileset>
            <fileset dir="${tutorials}/${src}">
                <exclude name="**/*.java"/>
            </fileset>
        </jar>
    </target>
    
    <!-- Clean the tutorial classes -->
    <target name="clean">
        <delete dir="${tutorials}/${bin}"/>
        <delete file="${tutorials}/${ant.project.name}-tutorials.jar"/>
        <delete file="${tutorials}/${ant.project.name}-stocktracker.jar"/>
    </target>
</project>