<!--
Licensed to the Apache Software Foundation (ASF) under one or more
contributor license agreements.  See the NOTICE file distributed with
this work for additional information regarding copyright ownership.
The ASF licenses this file to you under the Apache License,
Version 2.0 (the "License"); you may not use this file except in
compliance with the License.  You may obtain a copy of the License at

    http://www.apache.org/licenses/LICENSE-2.0

Unless required by applicable law or agreed to in writing, software
distributed under the License is distributed on an "AS IS" BASIS,
WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
See the License for the specific language governing permissions and
limitations under the License.
-->

<html>
<head>
<title>Calendars</title>
<link rel="stylesheet" href="tutorial.css">
<script src="http://java.com/js/deployJava.js"></script>

<!-- NOTE: Syntax highlighting script is LGPL -->
<script type="text/javascript" src="http://alexgorbatchev.com/pub/sh/current/scripts/shCore.js"></script>
<script type="text/javascript" src="http://alexgorbatchev.com/pub/sh/current/scripts/shBrushJava.js"></script>
<script type="text/javascript" src="http://alexgorbatchev.com/pub/sh/current/scripts/shBrushXml.js"></script>
<link type="text/css" rel="stylesheet" href="http://alexgorbatchev.com/pub/sh/current/styles/shCore.css"/>
<link type="text/css" rel="stylesheet" href="http://alexgorbatchev.com/pub/sh/current/styles/shThemeDefault.css"/>
<script type="text/javascript">
    SyntaxHighlighter.all();
</script>
</head>
<body>
<h1>Calendars</h1>

<p>Pivot supports two types of calendar components: a standalone <tt>Calendar</tt> component that can be used anywhere within an application's user interface, and a <tt>CalendarButton</tt> component that, like a <a href="lists.html">list button</a>, displays a popup calendar when pressed.</p>

<p>The following sample application demonstrates both types of components:</p>

<script src="version.js"></script>
<script>
var attributes = {code:"org.apache.pivot.wtk.BrowserApplicationContext$HostApplet",
    archive:"lib/pivot-core-" + version + ".jar"
        + ",lib/pivot-wtk-" + version + ".jar"
        + ",lib/pivot-wtk-" + version + ".terra.jar"
        + ",lib/pivot-tutorials-" + version + ".jar",
    width:300,
    height:400
};
var parameters = {application_class_name:"org.apache.pivot.tutorials.calendars.Calendars",
    codebase_lookup:false,
    java_arguments:"-Dsun.awt.noerasebackground=true -Dsun.awt.erasebackgroundonresize=true"
};
deployJava.writeAppletTag(attributes, parameters);
</script>

<p>The WTKX source is as follows:</p>

<pre class="brush:xml">
&lt;Window title="Calendars" maximized="true"
    xmlns:wtkx="http://pivot.apache.org/wtkx"
    xmlns="org.apache.pivot.wtk"&gt;
    &lt;content&gt;
        &lt;Border styles="{padding:8}"&gt;
            &lt;content&gt;
                &lt;Form styles="{rightAlignLabels:true}"&gt;
                    &lt;sections&gt;
                        &lt;Form.Section&gt;
                            &lt;Border Form.label="Calendar" styles="{padding:0, color:10}"&gt;
                                &lt;content&gt;
                                    &lt;Calendar wtkx:id="calendar"/&gt;
                                &lt;/content&gt;
                            &lt;/Border&gt;
                            &lt;CalendarButton wtkx:id="calendarButton" Form.label="Calendar button"/&gt;
                        &lt;/Form.Section&gt;
                        &lt;Form.Section&gt;
                            &lt;Label wtkx:id="selectedDateLabel" Form.label="Selected date"/&gt;
                        &lt;/Form.Section&gt;
                    &lt;/sections&gt;
                &lt;/Form&gt;
            &lt;/content&gt;
        &lt;/Border&gt;
    &lt;/content&gt;
&lt;/Window&gt;
</pre>

<p>The Java source is as follows. It simply registers event handlers that keep the selection state of the <tt>Calendar</tt> and <tt>CalendarButton</tt> in sync:</p>

<pre class="brush:java">
package org.apache.pivot.tutorials.calendars;

import org.apache.pivot.collections.Map;
import org.apache.pivot.util.CalendarDate;
import org.apache.pivot.wtk.Application;
import org.apache.pivot.wtk.Calendar;
import org.apache.pivot.wtk.CalendarButton;
import org.apache.pivot.wtk.CalendarButtonSelectionListener;
import org.apache.pivot.wtk.CalendarSelectionListener;
import org.apache.pivot.wtk.DesktopApplicationContext;
import org.apache.pivot.wtk.Display;
import org.apache.pivot.wtk.Label;
import org.apache.pivot.wtk.Window;
import org.apache.pivot.wtkx.WTKXSerializer;

public class Calendars implements Application {
    private Window window = null;
    private Calendar calendar = null;
    private CalendarButton calendarButton = null;
    private Label selectedDateLabel = null;

    private boolean updatingSelectedDate = false;

    @Override
    public void startup(Display display, Map&lt;String, String&gt; properties)
        throws Exception {
        WTKXSerializer wtkxSerializer = new WTKXSerializer();
        window = (Window)wtkxSerializer.readObject(this, "calendars.wtkx");
        calendar = (Calendar)wtkxSerializer.get("calendar");
        calendarButton = (CalendarButton)wtkxSerializer.get("calendarButton");
        selectedDateLabel = (Label)wtkxSerializer.get("selectedDateLabel");

        calendar.getCalendarSelectionListeners().add(new CalendarSelectionListener() {
            @Override
            public void selectedDateChanged(Calendar calendar, CalendarDate previousSelectedDate) {
                updateSelectedDate(calendar.getSelectedDate());
            }
        });

        calendarButton.getCalendarButtonSelectionListeners().add(new CalendarButtonSelectionListener() {
            @Override
            public void selectedDateChanged(CalendarButton calendarButton, CalendarDate previousSelectedDate) {
                updateSelectedDate(calendarButton.getSelectedDate());
            }
        });

        window.open(display);
    }

    @Override
    public boolean shutdown(boolean optional) {
        if (window != null) {
            window.close();
        }

        return false;
    }

    @Override
    public void suspend() {
    }

    @Override
    public void resume() {
    }

    private void updateSelectedDate(CalendarDate selectedDate) {
        if (!updatingSelectedDate) {
            updatingSelectedDate = true;

            calendar.setSelectedDate(selectedDate);
            calendar.setYear(selectedDate.year);
            calendar.setMonth(selectedDate.month);

            calendarButton.setSelectedDate(selectedDate);

            selectedDateLabel.setText(selectedDate.toString());

            updatingSelectedDate = false;
        }
    }

    public static void main(String[] args) {
        DesktopApplicationContext.main(Calendars.class, args);
    }
}
</pre>

<p>Next: <a href="menus.html">Menus</a></p>
</body>
</html>
