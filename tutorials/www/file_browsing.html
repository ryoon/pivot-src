<!--
Licensed to the Apache Software Foundation (ASF) under one or more
contributor license agreements.  See the NOTICE file distributed with
this work for additional information regarding copyright ownership.
The ASF licenses this file to you under the Apache License,
Version 2.0 (the "License"); you may not use this file except in
compliance with the License.  You may obtain a copy of the License at

    http://www.apache.org/licenses/LICENSE-2.0

Unless required by applicable law or agreed to in writing, software
distributed under the License is distributed on an "AS IS" BASIS,
WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
See the License for the specific language governing permissions and
limitations under the License.
-->

<html>
<head>
<title>File Browsing</title>
<link rel="stylesheet" href="tutorial.css">
<script src="http://java.com/js/deployJava.js"></script>

<!-- NOTE: Syntax highlighting script is LGPL -->
<script type="text/javascript" src="http://alexgorbatchev.com/pub/sh/current/scripts/shCore.js"></script>
<script type="text/javascript" src="http://alexgorbatchev.com/pub/sh/current/scripts/shBrushJava.js"></script>
<script type="text/javascript" src="http://alexgorbatchev.com/pub/sh/current/scripts/shBrushXml.js"></script>
<link type="text/css" rel="stylesheet" href="http://alexgorbatchev.com/pub/sh/current/styles/shCore.css"/>
<link type="text/css" rel="stylesheet" href="http://alexgorbatchev.com/pub/sh/current/styles/shThemeDefault.css"/>
<script type="text/javascript">
    SyntaxHighlighter.all();
</script>
</head>
<body>
<h1>File Browsing</h1>

<p>Pivot includes support for easily adding local file system access to an application. The following example demonstrates the use of the <tt>FileBrowserSheet</tt> class:</p>

<script src="version.js"></script>
<script>
var attributes = {code:"org.apache.pivot.wtk.BrowserApplicationContext$HostApplet",
    archive:"lib/pivot-core-" + version + ".signed.jar"
        + ",lib/pivot-wtk-" + version + ".signed.jar"
        + ",lib/pivot-wtk-" + version + ".terra.signed.jar"
        + ",lib/pivot-tutorials-" + version + ".signed.jar",
    width:640,
    height:480
};
var parameters = {application_class_name:"org.apache.pivot.tutorials.filebrowsing.FileBrowsing",
    codebase_lookup:false,
    java_arguments:"-Dsun.awt.noerasebackground=true -Dsun.awt.erasebackgroundonresize=true"
};
deployJava.writeAppletTag(attributes, parameters);
</script>

<p>It allows the user to browse the local file system using one of four supported modes:</p>

<ul>
<li><p><b>Open</b> - select a single file to open</p></li>
<li><p><b>Open Multiple</b> - select multiple files to open</p></li>
<li><p><b>Save As</b> - select a file name to save as</p></li>
<li><p><b>Save To</b> - select a folder to save to</p></li>
</ul>

<p>The WTKX source for the application is as follows:</p>

<pre class="brush:xml">
&lt;Window title="File Browser Sheets" maximized="true"
    xmlns:wtkx="http://pivot.apache.org/wtkx"
    xmlns="org.apache.pivot.wtk"&gt;
    &lt;wtkx:define&gt;
        &lt;ButtonGroup wtkx:id="fileBrowserSheetModeGroup"/&gt;
    &lt;/wtkx:define&gt;

    &lt;content&gt;
        &lt;Border styles="{padding:6}"&gt;
            &lt;content&gt;
                &lt;BoxPane orientation="vertical" styles="{spacing:6}"&gt;
                    &lt;Label text="Mode:" styles="{font:{bold:true}}"/&gt;

                    &lt;RadioButton buttonData="Open" buttonGroup="$fileBrowserSheetModeGroup" selected="true"&gt;
                        &lt;userData mode="open"/&gt;
                    &lt;/RadioButton&gt;
                    &lt;RadioButton buttonData="Open Multiple" buttonGroup="$fileBrowserSheetModeGroup"&gt;
                        &lt;userData mode="open_multiple"/&gt;
                    &lt;/RadioButton&gt;
                    &lt;RadioButton buttonData="Save As" buttonGroup="$fileBrowserSheetModeGroup"&gt;
                        &lt;userData mode="save_as"/&gt;
                    &lt;/RadioButton&gt;
                    &lt;RadioButton buttonData="Save To" buttonGroup="$fileBrowserSheetModeGroup"&gt;
                        &lt;userData mode="save_to"/&gt;
                    &lt;/RadioButton&gt;

                    &lt;PushButton wtkx:id="openSheetButton" buttonData="Open Sheet"/&gt;
                &lt;/BoxPane&gt;
            &lt;/content&gt;
        &lt;/Border&gt;
    &lt;/content&gt;
&lt;/Window&gt;
</pre>

<p>The Java source code is shown below. When the user presses the "Open Sheet" button, it creates a <tt>FileBrowserSheet</tt> using the selected mode and opens the sheet. When the sheet is closed, it simply displays an alert to the user reflecting the selection:</p>

<pre class="brush:java">
package org.apache.pivot.tutorials.filebrowsing;

import java.io.File;

import org.apache.pivot.collections.ArrayList;
import org.apache.pivot.collections.Map;
import org.apache.pivot.collections.Sequence;
import org.apache.pivot.wtk.Alert;
import org.apache.pivot.wtk.Application;
import org.apache.pivot.wtk.Button;
import org.apache.pivot.wtk.ButtonGroup;
import org.apache.pivot.wtk.ButtonPressListener;
import org.apache.pivot.wtk.DesktopApplicationContext;
import org.apache.pivot.wtk.Display;
import org.apache.pivot.wtk.FileBrowserSheet;
import org.apache.pivot.wtk.ListView;
import org.apache.pivot.wtk.MessageType;
import org.apache.pivot.wtk.PushButton;
import org.apache.pivot.wtk.Sheet;
import org.apache.pivot.wtk.SheetCloseListener;
import org.apache.pivot.wtk.Window;
import org.apache.pivot.wtkx.WTKX;
import org.apache.pivot.wtkx.WTKXSerializer;

public class FileBrowsing implements Application {
    private Window window = null;

    @WTKX private ButtonGroup fileBrowserSheetModeGroup = null;
    @WTKX private PushButton openSheetButton = null;

    @Override
    public void startup(Display display, Map&gt;String, String&gt; properties)
        throws Exception {
        WTKXSerializer wtkxSerializer = new WTKXSerializer();

        window = (Window)wtkxSerializer.readObject(getClass().getResource("file_browsing.wtkx"));
        wtkxSerializer.bind(this, FileBrowsing.class);

        openSheetButton.getButtonPressListeners().add(new ButtonPressListener() {
            @Override
            public void buttonPressed(Button button) {
                Button selection = fileBrowserSheetModeGroup.getSelection();

                String mode = (String)selection.getUserData().get("mode");
                final FileBrowserSheet fileBrowserSheet =
                    new FileBrowserSheet(FileBrowserSheet.Mode.valueOf(mode.toUpperCase()));

                fileBrowserSheet.open(window, new SheetCloseListener() {
                    @Override
                    public void sheetClosed(Sheet sheet) {
                        if (sheet.getResult()) {
                            Sequence&gt;File&gt; selectedFiles = fileBrowserSheet.getSelectedFiles();

                            ListView listView = new ListView();
                            listView.setListData(new ArrayList&gt;File&gt;(selectedFiles));
                            listView.setSelectMode(ListView.SelectMode.NONE);
                            listView.getStyles().put("backgroundColor", null);

                            Alert.alert(MessageType.INFO, "You selected:", listView, window);
                        } else {
                            Alert.alert(MessageType.INFO, "You didn't select anything.", window);
                        }
                    }
                });
            }
        });

        window.open(display);
    }

    @Override
    public boolean shutdown(boolean optional) {
        if (window != null) {
            window.close();
        }

        return false;
    }

    @Override
    public void suspend() {
    }

    @Override
    public void resume() {
    }

    public static void main(String[] args) {
        DesktopApplicationContext.main(FileBrowsing.class, args);
    }
}
</pre>

<p>Note that, internally, <tt>FileBrowserSheet</tt> uses an instance of the <tt>org.apache.pivot.wtk.FileBrowser</tt> class to perform the actual file system navigation. It is possible to use this component directly within an application to create a custom file browser; however, a discussion of the <tt>FileBrowser</tt> class is outside the scope of this tutorial.</p>

<p>Next: <a href="windows.html">Windows</a></p>
</body>
</html>
