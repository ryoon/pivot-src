<!--
Licensed to the Apache Software Foundation (ASF) under one or more
contributor license agreements.  See the NOTICE file distributed with
this work for additional information regarding copyright ownership.
The ASF licenses this file to you under the Apache License,
Version 2.0 (the "License"); you may not use this file except in
compliance with the License.  You may obtain a copy of the License at

    http://www.apache.org/licenses/LICENSE-2.0

Unless required by applicable law or agreed to in writing, software
distributed under the License is distributed on an "AS IS" BASIS,
WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
See the License for the specific language governing permissions and
limitations under the License.
-->

<html>
<head>
<title>List Buttons</title>
<link rel="stylesheet" href="tutorial.css">
<script src="http://java.com/js/deployJava.js"></script>

<!-- NOTE: Syntax highlighting script is LGPL -->
<script type="text/javascript" src="http://alexgorbatchev.com/pub/sh/current/scripts/shCore.js"></script>
<script type="text/javascript" src="http://alexgorbatchev.com/pub/sh/current/scripts/shBrushJava.js"></script>
<script type="text/javascript" src="http://alexgorbatchev.com/pub/sh/current/scripts/shBrushXml.js"></script>
<link type="text/css" rel="stylesheet" href="http://alexgorbatchev.com/pub/sh/current/styles/shCore.css"/>
<link type="text/css" rel="stylesheet" href="http://alexgorbatchev.com/pub/sh/current/styles/shThemeDefault.css"/>
<script type="text/javascript">
    SyntaxHighlighter.all();
</script>
</head>
<body>
<h1>List Buttons</h1>

<p>The following example demonstrates use of the <tt>ListButton</tt> component. Selecting an image name from the drop-down shows the corresponding image file in the image view on the right.</p>

<script src="version.js"></script>
<script>
var attributes = {code:"org.apache.pivot.wtk.BrowserApplicationContext$HostApplet",
    archive:"lib/pivot-core-" + version + ".jar"
        + ",lib/pivot-wtk-" + version + ".jar"
        + ",lib/pivot-wtk-" + version + ".terra.jar"
        + ",lib/pivot-tutorials-" + version + ".jar",
    width:480,
    height:340,
    style:"border:solid 1px #999999"
};
var parameters = {application_class_name:"org.apache.pivot.tutorials.lists.ListButtons",
    codebase_lookup:false,
    java_arguments:"-Dsun.awt.noerasebackground=true -Dsun.awt.erasebackgroundonresize=true"
};
deployJava.writeAppletTag(attributes, parameters);
</script>

<p>The WTKX source for the example is below. Like the previous example, list data is specified as an attribute containing a JSON array of strings; this value is used to load the image displayed to the right of the list button. Like <tt>ListView</tt>, <tt>ListButtons</tt> can also be populated programmatically using instances of <tt>ListItem</tt>.</p>

<pre class="brush:xml">
&lt;Window title="List Buttons" maximized="true"
    xmlns:wtkx="http://pivot.apache.org/wtkx"
    xmlns="org.apache.pivot.wtk"&gt;
    &lt;content&gt;
        &lt;TablePane styles="{showHorizontalGridLines: true, showVerticalGridLines:true,
            horizontalSpacing:1, verticalSpacing:1}"&gt;
            &lt;columns&gt;
                &lt;TablePane.Column width="-1"/&gt;
                &lt;TablePane.Column width="1*"/&gt;
            &lt;/columns&gt;
            &lt;rows&gt;
                &lt;TablePane.Row height="340"&gt;
                    &lt;BoxPane orientation="vertical" styles="{verticalAlignment:'top', padding: 4}"&gt;
                        &lt;Label text="Picture:"/&gt;
                        &lt;ListButton wtkx:id="listButton"
                            listData="['IMG_0725_2.jpg', 'IMG_0735_2.jpg', 'IMG_0767_2.jpg']"/&gt;
                    &lt;/BoxPane&gt;

                    &lt;ImageView wtkx:id="imageView" styles="{backgroundColor:'#404040'}"/&gt;
                &lt;/TablePane.Row&gt;
            &lt;/rows&gt;
        &lt;/TablePane&gt;
    &lt;/content&gt;
&lt;/Window&gt;
</pre>

<p>The Java source for the example is below:</p>

<pre class="brush:java">
package org.apache.pivot.tutorials.lists;

import java.net.URL;
import org.apache.pivot.collections.Map;
import org.apache.pivot.util.ThreadUtilities;
import org.apache.pivot.util.concurrent.TaskExecutionException;
import org.apache.pivot.wtk.Application;
import org.apache.pivot.wtk.ApplicationContext;
import org.apache.pivot.wtk.DesktopApplicationContext;
import org.apache.pivot.wtk.Display;
import org.apache.pivot.wtk.ImageView;
import org.apache.pivot.wtk.ListButton;
import org.apache.pivot.wtk.ListButtonSelectionListener;
import org.apache.pivot.wtk.Window;
import org.apache.pivot.wtk.media.Image;
import org.apache.pivot.wtkx.WTKXSerializer;

public class ListButtons implements Application {
    private Window window = null;
    private ListButton listButton = null;
    private ImageView imageView = null;

    private ListButtonSelectionListener listButtonSelectionListener =
        new ListButtonSelectionListener() {
        public void selectedIndexChanged(ListButton listButton, int previousIndex) {
            int index = listButton.getSelectedIndex();

            if (index != -1) {
                String item = (String)listButton.getListData().get(index);

                // Get the image URL for the selected item
                ClassLoader classLoader = ThreadUtilities.getClassLoader();
                URL imageURL = classLoader.getResource("org/apache/pivot/tutorials/" + item);

                // If the image has not been added to the resource cache yet,
                // add it
                Image image = (Image)ApplicationContext.getResourceCache().get(imageURL);

                if (image == null) {
                    try {
                        image = Image.load(imageURL);
                    } catch (TaskExecutionException exception) {
                        throw new RuntimeException(exception);
                    }

                    ApplicationContext.getResourceCache().put(imageURL, image);
                }

                // Update the image
                imageView.setImage(image);
            }
        }
    };

    public void startup(Display display, Map&lt;String, String&gt; properties) throws Exception {
        WTKXSerializer wtkxSerializer = new WTKXSerializer();
        window = (Window)wtkxSerializer.readObject(this, "list_buttons.wtkx");
        listButton = (ListButton)wtkxSerializer.get("listButton");
        imageView = (ImageView)wtkxSerializer.get("imageView");

        listButton.getListButtonSelectionListeners().add(listButtonSelectionListener);
        listButton.setSelectedIndex(0);

        window.open(display);
    }

    public boolean shutdown(boolean optional) {
        if (window != null) {
            window.close();
        }

        return false;
    }

    public void suspend() {
    }

    public void resume() {
    }

    public static void main(String[] args) {
        DesktopApplicationContext.main(ListButtons.class, args);
    }
}
</pre>

<p>Note that this example makes use of the global resource cache to store the loaded images. This cache can be used to store any kind of application-specific data that may be expensive to load. Entries are keyed by the URL from which they were retrieved, and, once placed in the cache, are available to all code within the application. When the list button's selection changes, the application first looks for an image in the resource cache; if it is not found, it is loaded and added to the cache. It is then set as the "image" property of the image view and displayed.</p>

<p>Next: <a href="text.html">Text</a></p>
</body>
</html>
